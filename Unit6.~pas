unit Unit6;

interface

uses
  Windows, Messages, SysUtils, Variants, Classes, Graphics, Controls, Forms,
  Dialogs, StdCtrls, ComCtrls, pngextra, Buttons, ExtCtrls;

type
  TForm6 = class(TForm)
    MouseSensitivity: TTrackBar;
    panel_negativo: TPanel;
    panel_positivo: TPanel;
    procedure FormCreate(Sender: TObject);
    procedure FormClose(Sender: TObject; var Action: TCloseAction);
    procedure FormKeyPress(Sender: TObject; var Key: Char);
    procedure MouseSensitivityChange(Sender: TObject);
  private
    { Private declarations }
  public
    { Public declarations }
  end;

var
  Form6: TForm6;

procedure Label_PosiNega(Valor_Mouse:Integer);

implementation

uses Unit1;

{$R *.dfm}

procedure Label_PosiNega(Valor_Mouse:Integer);
begin
 //------------------------------------------------------------------------
 if Valor_Mouse > 0 then
 begin
 Form6.panel_positivo.Caption:=' +'+IntToStr(Trunc(Valor_Mouse/1000));
 Form6.panel_negativo.Caption:='0  ';
 end
 else
 begin
 Form6.panel_positivo.Caption:='  0';
 Form6.panel_negativo.Caption:=' ' +IntToStr(Trunc(Valor_Mouse/1000))+'  ';
 end;
 //------------------------------------------------------------------------
end;

procedure TForm6.FormCreate(Sender: TObject);
var
Config_Fisico:TStringList;
i,Valor_Arquivo:Integer;
begin
Form6.Caption:=Form1_DGL.Label_Sense.Caption;
//---------------------------------------------------------
{HABILITA COMPONENTE DE SENSIBILIDADE DO MOUSE}
//---------------------------------------------------------
if (Mouse_Global = 0) then
begin
Config_Fisico:=TStringList.Create;
Config_Fisico.LoadFromFile(ExtractFilePath(Application.ExeName)+Array_Games[id][3]+Array_Games[id][6]);

  for i:=0 to Config_Fisico.Count-1 do
  begin
    if Pos('MouseAnalogScale1 = ',Config_Fisico[i]) = 1 then
    begin
    Valor_Arquivo:=StrToInt(Copy(Config_Fisico[i],22,Length(Config_Fisico[i])-20));
    MouseSensitivity.Position:=Valor_Arquivo-MouseAnalogY;
    Label_PosiNega(MouseSensitivity.Position);
    Break;
    end;
  end;

Config_Fisico.Free;
end
else
MouseSensitivity.Position:=Mouse_Global;
//---------------------------------------------------------
end;

procedure TForm6.FormClose(Sender: TObject; var Action: TCloseAction);
begin
Form1_DGL.RxCheckListBox1.SetFocus;
Form1_DGL.RxSense.StateOn:=False;
Form6.Release;
Form6:=Nil;
end;

procedure TForm6.FormKeyPress(Sender: TObject; var Key: Char);
begin
 //--------------------------------------------
 if (key <> #13) and (key <> #27) then
 MouseSensitivity.SetFocus;
 //--------------------------------------------
 if (key = #27) then
 Close;
 //--------------------------------------------
 if (key = #13) then
 begin
 Mouse_Global:=MouseSensitivity.Position;
 Close;
 end;
 //--------------------------------------------
end;

procedure TForm6.MouseSensitivityChange(Sender: TObject);
begin
Label_PosiNega(MouseSensitivity.Position);
ActiveControl:=Nil;
end;

end.

